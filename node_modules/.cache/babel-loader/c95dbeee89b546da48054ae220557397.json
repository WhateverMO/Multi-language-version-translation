{"ast":null,"code":"import request from \"@/request\";\nimport qs from \"qs\";\nexport default {\n  data() {\n    return {\n      books: \"\",\n      collectname: [],\n      collectbooks: []\n    };\n  },\n\n  methods: {\n    cancel(x) {\n      request.post(\"/api/user/del_collect/\" + x).then(res => {\n        alert(res.data.msg);\n      }); //拿阅读记录\n\n      request.get(\"/api/user/get_collection\").then(res => {\n        this.books = res.data.collect_books;\n        this.$forceUpdate();\n      }); //拿阅读记录\n    },\n\n    //创建图书收藏夹\n    buider() {\n      this.$prompt(\"请输入要创建的收藏夹名字\", \"提示\", {\n        confirmButtonText: \"确定\",\n        cancelButtonText: \"取消\"\n      }).then(({\n        value\n      }) => {\n        var data = {\n          libname: value\n        };\n        request.post(\"/api/user/create_collection\", qs.stringify(data)).then(res => {\n          if (res.data.code == 200) {\n            this.$message({\n              type: \"success\",\n              message: \"收藏夹创建成功\"\n            });\n            this.getnewcollect();\n          }\n        });\n      }).catch(() => {\n        this.$message({\n          type: \"info\",\n          message: \"取消输入\"\n        });\n      });\n    },\n\n    //获取收藏夹图书内容\n    collectbook(name) {\n      request.get(\"/api/user/get_collection/\" + name).then(res => {\n        if (res.data.code == 200) {\n          sessionStorage.setItem(\"collectname\", name);\n          this.collectbooks = res.data.collection_book_list;\n          console.log(this.collectbooks);\n        }\n      });\n    },\n\n    //删除收藏夹\n    delecollectname(name) {\n      request.delete(\"/api/user/dele_collection/\" + name).then(res => {\n        console.log(res.data);\n\n        if (res.data.code == 200) {\n          alert(\"删除收藏夹成功\");\n          this.getnewcollect();\n        }\n      });\n    },\n\n    //获取所有收藏夹的名字\n    getnewcollect() {\n      request.get(\"/api/user/get_collection_lib\").then(res => {\n        console.log(res.data);\n        this.collectname = res.data.collections;\n      }); //获取所有收藏夹名字\n    },\n\n    //删除收藏夹里的图书\n    delecollectbook(id) {\n      var collectname = sessionStorage.getItem(\"collectname\");\n      request.delete(\"/api/user/del_collect/\" + id + \"/\" + collectname).then(res => {\n        console.log(res.data);\n\n        if (res.data.code == 200) {\n          alert(\"删除收藏图书成功\");\n          this.collectbook(collectname);\n        }\n      });\n    }\n\n  },\n\n  mounted() {\n    request.get(\"/api/user/get_collection_lib\").then(res => {\n      this.collectname = res.data.collections;\n      request.get(\"/api/user/get_collection/\" + res.data.collections[0]).then(res => {\n        this.collectbooks = res.data.collection_book_list;\n      });\n    }); //获取所有收藏夹名字\n\n    console.log(this.collectname);\n  }\n\n};","map":{"version":3,"mappings":"AAuCA;AACA;AACA;EACAA;IACA;MACAC,SADA;MAEAC,eAFA;MAGAC;IAHA;EAKA,CAPA;;EAQAC;IACAC;MACAC;QACAC;MACA,CAFA,EADA,CAGA;;MACAD;QACA;QACA;MACA,CAHA,EAJA,CAOA;IACA,CATA;;IAUA;IACAE;MACA;QACAC,uBADA;QAEAC;MAFA,GAIAC,IAJA,CAIA;QAAAC;MAAA;QACA;UACAC;QADA;QAGAP,QACAQ,IADA,CACA,6BADA,EACAC,kBADA,EAEAJ,IAFA,CAEAK;UACA;YACA;cACAC,eADA;cAEAC;YAFA;YAIA;UACA;QACA,CAVA;MAWA,CAnBA,EAoBAC,KApBA,CAoBA;QACA;UACAF,YADA;UAEAC;QAFA;MAIA,CAzBA;IA0BA,CAtCA;;IAuCA;IACAE;MACAd;QACA;UACAe;UACA;UACAC;QACA;MACA,CANA;IAOA,CAhDA;;IAiDA;IACAC;MACAjB;QACAgB;;QACA;UACAf;UACA;QACA;MACA,CANA;IAOA,CA1DA;;IA2DA;IACAiB;MACAlB;QACAgB;QACA;MACA,CAHA,EADA,CAIA;IACA,CAjEA;;IAkEA;IACAG;MACA;MACAnB,QACAoB,MADA,CACA,iDADA,EAEAf,IAFA,CAEAK;QACAM;;QACA;UACAf;UACA;QACA;MACA,CARA;IASA;;EA9EA,CARA;;EAwFAoB;IACArB;MACA;MACAA,QACAsB,GADA,CACA,qDADA,EAEAjB,IAFA,CAEAK;QACA;MACA,CAJA;IAKA,CAPA,EADA,CAQA;;IACAM;EACA;;AAlGA","names":["data","books","collectname","collectbooks","methods","cancel","request","alert","buider","confirmButtonText","cancelButtonText","then","value","libname","post","qs","res","type","message","catch","collectbook","sessionStorage","console","delecollectname","getnewcollect","delecollectbook","delete","mounted","get"],"sourceRoot":"src/components/information","sources":["collect.vue"],"sourcesContent":["<template>\r\n  <div class=\"all\">\r\n    <div class=\"list\">\r\n      <ul class=\"title\">\r\n        我的收藏夹\r\n      </ul>\r\n      <ul\r\n        v-for=\"(name, index) in collectname\"\r\n        :key=\"index\"\r\n        @click=\"collectbook(name)\"\r\n      >\r\n        <li>\r\n          {{ name }}\r\n          <i class=\"el-icon-delete\" @click=\"delecollectname(name)\"></i>\r\n        </li>\r\n      </ul>\r\n      <ul>\r\n        <el-button type=\"text\" @click=\"buider\">创建收藏夹</el-button>\r\n      </ul>\r\n    </div>\r\n    <div class=\"content\">\r\n      <ul class=\"title\">\r\n        我收藏的图书\r\n      </ul>\r\n      <ul\r\n        v-for=\"(item, index) in this.collectbooks\"\r\n        :key=\"index\"\r\n        @click=\"collectbook(item.book_id)\"\r\n      >\r\n        <li>\r\n          {{ item.book_name }}___{{ item.desc }}\r\n          <i class=\"el-icon-delete\" @click=\"delecollectbook(item.book_id)\"></i>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport request from \"@/request\";\r\nimport qs from \"qs\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      books: \"\",\r\n      collectname: [],\r\n      collectbooks: [],\r\n    };\r\n  },\r\n  methods: {\r\n    cancel(x) {\r\n      request.post(\"/api/user/del_collect/\" + x).then((res) => {\r\n        alert(res.data.msg);\r\n      }); //拿阅读记录\r\n      request.get(\"/api/user/get_collection\").then((res) => {\r\n        this.books = res.data.collect_books;\r\n        this.$forceUpdate();\r\n      }); //拿阅读记录\r\n    },\r\n    //创建图书收藏夹\r\n    buider() {\r\n      this.$prompt(\"请输入要创建的收藏夹名字\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n      })\r\n        .then(({ value }) => {\r\n          var data = {\r\n            libname: value,\r\n          };\r\n          request\r\n            .post(\"/api/user/create_collection\", qs.stringify(data))\r\n            .then((res) => {\r\n              if (res.data.code == 200) {\r\n                this.$message({\r\n                  type: \"success\",\r\n                  message: \"收藏夹创建成功\",\r\n                });\r\n                this.getnewcollect();\r\n              }\r\n            });\r\n        })\r\n        .catch(() => {\r\n          this.$message({\r\n            type: \"info\",\r\n            message: \"取消输入\",\r\n          });\r\n        });\r\n    },\r\n    //获取收藏夹图书内容\r\n    collectbook(name) {\r\n      request.get(\"/api/user/get_collection/\" + name).then((res) => {\r\n        if (res.data.code == 200) {\r\n          sessionStorage.setItem(\"collectname\", name);\r\n          this.collectbooks = res.data.collection_book_list;\r\n          console.log(this.collectbooks);\r\n        }\r\n      });\r\n    },\r\n    //删除收藏夹\r\n    delecollectname(name) {\r\n      request.delete(\"/api/user/dele_collection/\" + name).then((res) => {\r\n        console.log(res.data);\r\n        if (res.data.code == 200) {\r\n          alert(\"删除收藏夹成功\");\r\n          this.getnewcollect();\r\n        }\r\n      });\r\n    },\r\n    //获取所有收藏夹的名字\r\n    getnewcollect() {\r\n      request.get(\"/api/user/get_collection_lib\").then((res) => {\r\n        console.log(res.data);\r\n        this.collectname = res.data.collections;\r\n      }); //获取所有收藏夹名字\r\n    },\r\n    //删除收藏夹里的图书\r\n    delecollectbook(id) {\r\n      var collectname = sessionStorage.getItem(\"collectname\");\r\n      request\r\n        .delete(\"/api/user/del_collect/\" + id + \"/\" + collectname)\r\n        .then((res) => {\r\n          console.log(res.data);\r\n          if (res.data.code == 200) {\r\n            alert(\"删除收藏图书成功\");\r\n            this.collectbook(collectname);\r\n          }\r\n        });\r\n    },\r\n  },\r\n  mounted() {\r\n    request.get(\"/api/user/get_collection_lib\").then((res) => {\r\n      this.collectname = res.data.collections;\r\n      request\r\n        .get(\"/api/user/get_collection/\" + res.data.collections[0])\r\n        .then((res) => {\r\n          this.collectbooks = res.data.collection_book_list;\r\n        });\r\n    }); //获取所有收藏夹名字\r\n    console.log(this.collectname);\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\nli {\r\n  padding: 20px;\r\n  font-family: \"Times New Roman\", Times, serif;\r\n  font-size: 20px;\r\n}\r\nli:hover .el-icon-delete {\r\n  display: inline-block;\r\n}\r\nli:hover {\r\n  cursor: pointer;\r\n  background-color: rgb(243, 240, 235);\r\n  color: red;\r\n}\r\n.list {\r\n  margin-left: 20vw;\r\n  margin-top: 10vh;\r\n  float: left;\r\n}\r\n.title {\r\n  letter-spacing: 20px;\r\n  font-size: 25px;\r\n  margin-bottom: 20px;\r\n  margin-top: 20px;\r\n  font-family: \"Times New Roman\", Times, serif;\r\n  margin-left: 20px;\r\n  color: rgb(17, 155, 206);\r\n}\r\n.content {\r\n  float: left;\r\n  margin-left: 10vw;\r\n  margin-top: 10vh;\r\n}\r\n.el-icon-delete {\r\n  display: none;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import qs from \"qs\";\nimport request from \"@/request\";\nexport default {\n  data() {\n    return {\n      tableData: [{}],\n      textarea: \"\",\n      bookname: \"\",\n      bookauthor: \"\",\n      list: \"[]\",\n      bookintro: \"\",\n      bookid: \"\",\n      cover: \"\",\n      dialogVisible: false,\n      collect: []\n    };\n  },\n\n  methods: {\n    statread() {\n      sessionStorage.setItem(\"bookno\", 1);\n      this.$router.push(\"/readbook\");\n    },\n\n    read(bookno) {\n      sessionStorage.setItem(\"bookno\", bookno);\n      this.$router.push(\"/readbook\");\n    },\n\n    send() {\n      var data = {\n        barrage: this.textarea\n      };\n      var bookid = sessionStorage.getItem(\"bookid\");\n      request.post(\"/api/user/read_book/introduce/\" + bookid, qs.stringify(data)).then(res => {\n        if (res.data.code == 200) {\n          alert(\"发送成功\");\n          this.textarea = \"\";\n          request.get(\"/api/user/read_book/introduce/\" + bookid).then(res => {\n            this.bookauthor = res.data.author_name;\n            this.bookintro = res.data.book_describe;\n            this.bookname = res.data.book_name;\n            this.list = res.data.content_list;\n            this.cover = res.data.cover_path;\n            this.tableData = res.data.barrages;\n          });\n        } else {\n          alert(\"请登录后再发送评论哦~\");\n        }\n      });\n    },\n\n    open() {\n      request.get(\"/api/user/get_collection_lib\").then(res => {\n        console.log(res.data);\n        this.$select(\"请选择收藏夹\", res.data.collections, {\n          confirmButtonText: \"确定\",\n          cancelButtonText: \"取消\"\n        }).then(({\n          value\n        }) => {\n          var data = {\n            libname: value\n          };\n          console.log(value); // request\n          //   .post(\"/api/user/create_collection\", qs.stringify(data))\n          //   .then((res) => {\n          //     if (res.data.code == 200) {\n          //       this.$message({\n          //         type: \"success\",\n          //         message: \"收藏夹创建成功 \",\n          //       });\n          //     } else {\n          //       this.$message({\n          //         type: \"success\",\n          //         message: \"收藏夹创建失败 \",\n          //       });\n          //     }\n          //   });\n        }).catch(() => {\n          this.$message({\n            type: \"info\",\n            message: \"取消创建收藏夹\"\n          });\n        });\n      });\n    },\n\n    handleClose(done) {\n      this.$confirm(\"确认关闭？\").then(_ => {\n        done();\n      }).catch(_ => {});\n    },\n\n    showcollect() {\n      dialogVisible = true;\n      request.get(\"/api/user/get_collection_lib\").then(res => {\n        console.log(res.data);\n\n        if (res.data.code == 200) {\n          this.collect = res.data.collections;\n        }\n      });\n    }\n\n  },\n\n  mounted() {\n    this.bookid = sessionStorage.getItem(\"bookid\");\n    request.get(\"/api/user/read_book/introduce/\" + this.bookid).then(res => {\n      this.bookauthor = res.data.author_name;\n      this.bookintro = res.data.book_describe;\n      this.bookname = res.data.book_name;\n      this.list = res.data.content_list;\n      this.cover = res.data.cover_path;\n      this.tableData = res.data.barrages;\n      sessionStorage.setItem(\"maxbookno\", this.list.length);\n    });\n  }\n\n};","map":{"version":3,"mappings":"AAuEA;AACA;AACA;EACAA;IACA;MACAC,eADA;MAEAC,YAFA;MAGAC,YAHA;MAIAC,cAJA;MAKAC,UALA;MAMAC,aANA;MAOAC,UAPA;MAQAC,SARA;MASAC,oBATA;MAUAC;IAVA;EAYA,CAdA;;EAeAC;IACAC;MACAC;MACA;IACA,CAJA;;IAKAC;MACAD;MACA;IACA,CARA;;IASAE;MACA;QACAC;MADA;MAGA;MACAC,QACAC,IADA,CACA,yCADA,EACAC,kBADA,EAEAC,IAFA,CAEAC;QACA;UACAC;UACA;UACAL,QACAM,GADA,CACA,yCADA,EAEAH,IAFA,CAEAC;YACA;YACA;YACA;YACA;YACA;YACA;UACA,CATA;QAUA,CAbA,MAaA;UACAC;QACA;MACA,CAnBA;IAoBA,CAlCA;;IAmCAE;MACAP;QACAQ;QACA;UACAC,uBADA;UAEAC;QAFA,GAIAP,IAJA,CAIA;UAAAQ;QAAA;UACA;YAAAC;UAAA;UACAJ,mBAFA,CAGA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;QACA,CAtBA,EAuBAK,KAvBA,CAuBA;UACA;YACAC,YADA;YAEAC;UAFA;QAIA,CA5BA;MA6BA,CA/BA;IAgCA,CApEA;;IAqEAC;MACA,uBACAb,IADA,CACAc;QACAC;MACA,CAHA,EAIAL,KAJA,CAIAI,OAJA;IAKA,CA3EA;;IA4EAE;MACA3B;MACAQ;QACAQ;;QACA;UACA;QACA;MACA,CALA;IAMA;;EApFA,CAfA;;EAsGAY;IACA;IACApB;MACA;MACA;MACA;MACA;MACA;MACA;MACAJ;IACA,CARA;EASA;;AAjHA","names":["data","tableData","textarea","bookname","bookauthor","list","bookintro","bookid","cover","dialogVisible","collect","methods","statread","sessionStorage","read","send","barrage","request","post","qs","then","res","alert","get","open","console","confirmButtonText","cancelButtonText","value","libname","catch","type","message","handleClose","_","done","showcollect","mounted"],"sourceRoot":"src/components/read","sources":["center.vue"],"sourcesContent":["<template>\r\n  <div class=\"bc\">\r\n    <div id=\"head\">\r\n      <div id=\"headl\"><img :src=\"this.cover\" /></div>\r\n      <div id=\"headr\">\r\n        <ul>\r\n          <li>书名:《{{ bookname }}》</li>\r\n          <li>作者:{{ bookauthor }}</li>\r\n          <li class=\"intro\">简介:{{ bookintro }}</li>\r\n          <li>\r\n            <el-button type=\"primary\" plain @click=\"statread\"\r\n              >点击阅读</el-button\r\n            >\r\n            <el-button type=\"primary\" plain>关注作者</el-button>\r\n            <el-button type=\"primary\" @click=\"showcollect\">加入书架</el-button>\r\n\r\n            <el-dialog\r\n              title=\"提示\"\r\n              :visible.sync=\"dialogVisible\"\r\n              width=\"30%\"\r\n              :before-close=\"handleClose\"\r\n            >\r\n              <span v-for=\"\">\r\n                <el-radio v-model=\"radio\" label=\"1\">备选项</el-radio></span\r\n              >\r\n\r\n              <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button @click=\"dialogVisible = false\">取 消</el-button>\r\n                <el-button type=\"primary\" @click=\"dialogVisible = false\"\r\n                  >确 定</el-button\r\n                >\r\n              </span>\r\n            </el-dialog>\r\n          </li>\r\n        </ul>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"center\">\r\n      <div href=\"#\" class=\"title\">目录</div>\r\n      <div class=\"content\">\r\n        <li v-for=\"(item, index) in list\" :key=\"index\" @click=\"read(index + 1)\">\r\n          {{ item }}\r\n        </li>\r\n      </div>\r\n    </div>\r\n\r\n    <div class=\"comment\">\r\n      <div class=\"title\">粉丝互动</div>\r\n      <el-table :data=\"tableData\" border style=\"width: 80%\">\r\n        <el-table-column prop=\"user_name\" label=\"用户\" width=\"180\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"barrage\" label=\"评论\"> </el-table-column>\r\n        <el-table-column prop=\"time\" label=\"时间\"> </el-table-column>\r\n      </el-table>\r\n      <el-input\r\n        type=\"text\"\r\n        :rows=\"2\"\r\n        placeholder=\"发表你的评论\"\r\n        v-model=\"textarea\"\r\n        class=\"sendtext\"\r\n      >\r\n      </el-input>\r\n      <el-button type=\"primary\" plain class=\"send\" @click=\"send\"\r\n        >点击发送</el-button\r\n      >\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport qs from \"qs\";\r\nimport request from \"@/request\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      tableData: [{}],\r\n      textarea: \"\",\r\n      bookname: \"\",\r\n      bookauthor: \"\",\r\n      list: \"[]\",\r\n      bookintro: \"\",\r\n      bookid: \"\",\r\n      cover: \"\",\r\n      dialogVisible: false,\r\n      collect: [],\r\n    };\r\n  },\r\n  methods: {\r\n    statread() {\r\n      sessionStorage.setItem(\"bookno\", 1);\r\n      this.$router.push(\"/readbook\");\r\n    },\r\n    read(bookno) {\r\n      sessionStorage.setItem(\"bookno\", bookno);\r\n      this.$router.push(\"/readbook\");\r\n    },\r\n    send() {\r\n      var data = {\r\n        barrage: this.textarea,\r\n      };\r\n      var bookid = sessionStorage.getItem(\"bookid\");\r\n      request\r\n        .post(\"/api/user/read_book/introduce/\" + bookid, qs.stringify(data))\r\n        .then((res) => {\r\n          if (res.data.code == 200) {\r\n            alert(\"发送成功\");\r\n            this.textarea = \"\";\r\n            request\r\n              .get(\"/api/user/read_book/introduce/\" + bookid)\r\n              .then((res) => {\r\n                this.bookauthor = res.data.author_name;\r\n                this.bookintro = res.data.book_describe;\r\n                this.bookname = res.data.book_name;\r\n                this.list = res.data.content_list;\r\n                this.cover = res.data.cover_path;\r\n                this.tableData = res.data.barrages;\r\n              });\r\n          } else {\r\n            alert(\"请登录后再发送评论哦~\");\r\n          }\r\n        });\r\n    },\r\n    open() {\r\n      request.get(\"/api/user/get_collection_lib\").then((res) => {\r\n        console.log(res.data);\r\n        this.$select(\"请选择收藏夹\", res.data.collections, {\r\n          confirmButtonText: \"确定\",\r\n          cancelButtonText: \"取消\",\r\n        })\r\n          .then(({ value }) => {\r\n            var data = { libname: value };\r\n            console.log(value);\r\n            // request\r\n            //   .post(\"/api/user/create_collection\", qs.stringify(data))\r\n            //   .then((res) => {\r\n            //     if (res.data.code == 200) {\r\n            //       this.$message({\r\n            //         type: \"success\",\r\n            //         message: \"收藏夹创建成功 \",\r\n            //       });\r\n            //     } else {\r\n            //       this.$message({\r\n            //         type: \"success\",\r\n            //         message: \"收藏夹创建失败 \",\r\n            //       });\r\n            //     }\r\n            //   });\r\n          })\r\n          .catch(() => {\r\n            this.$message({\r\n              type: \"info\",\r\n              message: \"取消创建收藏夹\",\r\n            });\r\n          });\r\n      });\r\n    },\r\n    handleClose(done) {\r\n      this.$confirm(\"确认关闭？\")\r\n        .then((_) => {\r\n          done();\r\n        })\r\n        .catch((_) => {});\r\n    },\r\n    showcollect() {\r\n      dialogVisible = true;\r\n      request.get(\"/api/user/get_collection_lib\").then((res) => {\r\n        console.log(res.data);\r\n        if (res.data.code == 200) {\r\n          this.collect = res.data.collections;\r\n        }\r\n      });\r\n    },\r\n  },\r\n\r\n  mounted() {\r\n    this.bookid = sessionStorage.getItem(\"bookid\");\r\n    request.get(\"/api/user/read_book/introduce/\" + this.bookid).then((res) => {\r\n      this.bookauthor = res.data.author_name;\r\n      this.bookintro = res.data.book_describe;\r\n      this.bookname = res.data.book_name;\r\n      this.list = res.data.content_list;\r\n      this.cover = res.data.cover_path;\r\n      this.tableData = res.data.barrages;\r\n      sessionStorage.setItem(\"maxbookno\", this.list.length);\r\n    });\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.bc {\r\n  margin-left: 10vw;\r\n}\r\n.intro {\r\n  overflow: hidden;\r\n  display: -webkit-box;\r\n  -webkit-line-clamp: 6;\r\n  -webkit-box-orient: vertical;\r\n  text-overflow: ellipsis;\r\n}\r\nimg {\r\n  width: 200px;\r\n  height: 200px;\r\n}\r\n#head {\r\n  margin-top: 10px;\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-top: 40px;\r\n  font-size: 15px;\r\n}\r\n#headl {\r\n  width: 300px;\r\n}\r\n#headr {\r\n  width: 500px;\r\n  font-family: \"Courier New\", Courier, monospace;\r\n  font-size: 15px;\r\n}\r\n#headr .el-button {\r\n  width: 100px;\r\n  height: 40px;\r\n}\r\n#head li {\r\n  margin-top: 20px;\r\n}\r\n.title {\r\n  letter-spacing: 20px;\r\n  font-size: 25px;\r\n  margin-bottom: 20px;\r\n  margin-top: 20px;\r\n  font-family: \"Times New Roman\", Times, serif;\r\n  margin-left: 20px;\r\n  color: crimson;\r\n}\r\n.content :hover {\r\n  color: #2cdfe2;\r\n  cursor: pointer;\r\n}\r\n.content li:nth-child(odd) {\r\n  margin-left: 150px;\r\n}\r\n\r\n.content li {\r\n  display: inline-flex;\r\n  width: 400px;\r\n  margin-bottom: 20px;\r\n  font-size: 18px;\r\n  font-family: \"Courier New\", Courier, monospace;\r\n}\r\n\r\n.comment {\r\n  opacity: 0.8;\r\n}\r\n.sendtext {\r\n  margin-top: 25px;\r\n  margin-left: 200px;\r\n  width: 600px;\r\n  margin-left: 150px;\r\n  margin-bottom: 50px;\r\n}\r\n.send {\r\n  height: 42px;\r\n  margin-left: 5px;\r\n}\r\n.el-table {\r\n  text-align: center;\r\n  margin: 0 auto;\r\n  font-size: 15px;\r\n  letter-spacing: 2px;\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}